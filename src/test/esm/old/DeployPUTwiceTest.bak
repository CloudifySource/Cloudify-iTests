package test.esm.old;

import org.openspaces.admin.esm.ElasticServiceManager;
import org.openspaces.admin.esm.deployment.ElasticDataGridDeployment;
import org.openspaces.admin.gsa.GridServiceAgent;
import org.openspaces.admin.pu.ProcessingUnit;
import org.testng.Assert;
import org.testng.annotations.Test;

import test.AbstractTest;
import test.utils.AdminUtils;

public class DeployPUTwiceTest extends AbstractTest{

	//@Test
	public void test(){
		ElasticServiceManager esm= admin.getElasticServiceManagers().waitForAtLeastOne();
		GridServiceAgent gsa = admin.getGridServiceAgents().waitForAtLeastOne();
		AdminUtils.loadGSM(gsa);
		AdminUtils.loadGSC(gsa);
		
		ProcessingUnit pu = esm.deploy(new ElasticDataGridDeployment("esmDataGrid").
				 capacity("500m", "500m")
				.highlyAvailable(false) 
				.publicDeploymentIsolation() 
				.maximumJavaHeapSize("250m").initialJavaHeapSize("250m")); 
		pu.waitFor(pu.getTotalNumberOfInstances());
		
		ProcessingUnit pu2 = esm.deploy(new ElasticDataGridDeployment("esmDataGrid").
				 capacity("500m", "500m")
				.highlyAvailable(false) 
				.publicDeploymentIsolation() 
				.maximumJavaHeapSize("250m").initialJavaHeapSize("250m"));
		Assert.assertEquals(pu, pu2);
	}
	
}
